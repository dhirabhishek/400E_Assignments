knitr::opts_chunk$set(echo = TRUE)
#install any of these you might not have already
library(ggplot2)
library(edgeR)
install.packages("edgeR")
install.packages(edgeR)
install.packages("edgeR")
install.packages("BiocManager")
BiocManager::install("edgeR")
#install any of these you might not have already
library(ggplot2)
library(edgeR)
library(reshape)
install.packages("reshape")
library(GenomicRanges)
install.packages(GenomicRanges)
BiocManager::install("GenomicRanges")
library(csaw)
install.packages("csaw")
BiocManager::install("csaw")
BiocManager::install("Biostrings")
#install any of these you might not have already
library(ggplot2)
library(edgeR)
library(reshape)
library(GenomicRanges)
library(csaw)
BiocManager::install("csaw")
update.packages()
#install any of these you might not have already
library(ggplot2)
library(edgeR)
library(reshape)
library(GenomicRanges)
library(csaw)
knitr::opts_chunk$set(echo = TRUE)
#install any of these you might not have already
library(ggplot2)
library(edgeR)
library(reshape)
library(GenomicRanges)
library(csaw)
library(Biostrings)
library(Biostrings)
library(csaw)
#install any of these you might not have already
library(ggplot2)
library(edgeR)
library(reshape)
library(GenomicRanges)
library(csaw)
library(Biostrings)
#download the data
atacSeqData = read.table(textConnection(readLines(gzcon(url("ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE148nnn/GSE148175/suppl/GSE148175_count_matrix_raw_atac_BRM014_ACBI1.csv.gz")))),
sep=",", stringsAsFactors = FALSE, header = TRUE)
#create a sample metadata data.frame
samples = data.frame(ID = names(atacSeqData)[2:ncol(atacSeqData)])
samples$replicate = gsub("(R[12])_([0-9]+[minh]+)_(.*)$","\\1",samples$ID)
samples$timeName = gsub("(R[12])_([0-9]+[minh]+)_(.*)$","\\2",samples$ID)
samples$treatment = gsub("(R[12])_([0-9]+[minh]+)_(.*)$","\\3",samples$ID)
samples$treatment[samples$treatment=="N"]="BRM014"
samples$time= as.numeric(gsub("[a-z]*","",samples$timeName))
samples$time[grepl("min",samples$timeName)]=samples$time[grepl("min",samples$timeName)]/60
View(atacSeqData)
View(samples)
#here, if the point is there, it means such a sample exists, if absent it means that there is no such sample
#ggplot(data = sameMapped, aes(x=start_ori, y=start_nonDet)) +
#geom_point(color="steelblue") +
#facet_wrap(~ chr_ori)
ggplot(data =samples, aes(x=time, y = treatment))+ facet_wrap(~replicate)
#here, if the point is there, it means such a sample exists, if absent it means that there is no such sample
#ggplot(data = sameMapped, aes(x=start_ori, y=start_nonDet)) +
#geom_point(color="steelblue") +
#facet_wrap(~ chr_ori)
ggplot(data =samples, aes(x=time, y = treatment))+
geom_point()+
facet_wrap(~replicate)
